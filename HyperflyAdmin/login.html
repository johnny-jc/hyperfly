<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>HyperflyAdmin</title>

    <link rel="stylesheet" href="static/plugins/fontawesome-free-5.15.3-web/css/all.css">
    <link rel="stylesheet" href="static/plugins/icheck-bootstrap/icheck-bootstrap.min.css">
    <link rel="stylesheet" href="static/plugins/AdminLTE-3.1.0/dist/css/adminlte.css">

</head>
<body class="hold-transition login-page">
<div class="login-box">
    <!-- /.login-logo -->
    <div class="card card-outline card-primary">
        <div class="card-header text-center">
            <a href="javascript:void(0)" class="h1"><b>Hyperfly</b>Admin</a>
        </div>
        <div class="card-body">
            <p class="login-box-msg">登录后台管理系统</p>

            <div id="loginForm">
                <div class="input-group mb-3">
                    <input type="text" id="username" name="username" class="form-control" placeholder="账号">
                    <div class="input-group-append">
                        <div class="input-group-text">
                            <span class="fas fa-user"></span>
                        </div>
                    </div>
                </div>
                <div class="input-group mb-3">
                    <input type="password" id="password" name="password" class="form-control" placeholder="密码">
                    <div class="input-group-append">
                        <div class="input-group-text">
                            <span class="fas fa-lock"></span>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-8">
                        <div class="icheck-primary">
                            <input type="checkbox" id="remember">
                            <label for="remember">
                                记住密码
                            </label>
                        </div>
                    </div>
                    <!-- /.col -->
                    <div class="col-4">
                        <button type="button" id="do-login" class="btn btn-primary btn-block">登录</button>
                    </div>
                    <!-- /.col -->
                </div>
            </div>

            <!-- /.social-auth-links -->

        </div>
        <!-- /.card-body -->
    </div>
    <!-- /.card -->
</div>
<!-- /.login-box -->

<!-- jQuery -->
<script src="static/plugins/jquery/jquery.min.js"></script>
<!-- Bootstrap 4 -->
<script src="static/plugins/bootstrap-5.0.0-beta3-dist/js/bootstrap.bundle.js"></script>
<!-- AdminLTE App -->
<script src="static/plugins/AdminLTE-3.1.0/dist/js/adminlte.js"></script>
<script src="static/plugins/layer/layer.js"></script>
<script src="../../static/plugins/layui/layui.all.js"></script>
<script src="static/js/base.js"></script>


</body>
<script type="text/javascript">
    var jq = $
    jq(document).ready(function () {
        jq("#do-login").on("click", function () {
            var username = jq("#username").val()
            var password = jq("#password").val()

            if (username.length === 0) {
                return layerWarning('请填写账号')
            }
            if (password.length === 0) {
                return layerWarning('请填写密码')
            }
            var url = getRequestUrl('/Admin/v1/Admin/login')
            //防止重复提交
            jq("#username").val("")
            jq("#password").val("")
            var data = {'username': username, 'password': password}
            openLoad()
            ajaxPost(url, data, function (response) {
                closeLoad()
                if (isResponseFail(getResponseCode(response))) {
                    layerFail(getResponseMessage(response), function () {
                        jq("#username").val(username)
                        jq("#password").val(password)
                    })
                }
                if (isResponseSuccess(getResponseCode(response))) {
                    layerSuccess(getResponseMessage(response), function () {
                        var user = getResponseData(response).user
                        setAdminAccessTokenCache(user.access_token)
                        redirectToIndex()
                    })
                }
            })
        })
    })
</script>

</html>